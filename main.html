<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grelo Home Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Coiny&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=SUSE:wght@100..800&display=swap" rel="stylesheet">
   
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Include Font Awesome for social media icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
        <div class="container-fluid navbar-container">
            <a class="navbar-brand" href="#" style="font-family:Coiny, system-ui;">ULAVAN</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" id="navbarContent">
                <form class="d-flex w-50">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                </form>
                <div class="d-lg-none">
                    <button class="btn btn-outline-primary w-100 mb-2" type="button">Login</button>
                    <button class="btn btn-primary w-100" type="button">Sign Up</button>
                </div>
            </div>
            <div class="d-flex align-items-center">
                <a href="cart.html" class="btn btn-outline-secondary me-3 d-none d-lg-inline"><i class="fas fa-shopping-cart"></i></a>
                <button class="btn btn-outline-primary me-2 d-none d-lg-inline" type="button">Login</button>
                <button class="btn btn-primary d-none d-lg-inline" type="button">Sign Up</button>
                <a href="cart.html" class="btn btn-outline-secondary d-lg-none me-2"><i class="fas fa-shopping-cart"></i></a>
            </div>
        </div>
    </nav>     
      
    <div class="container">
        <div class="offer-container">
            <div class="offer-wrapper">
                <div class="offer-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTLoHP7NTqjpRpRII-RiIuBi7cuWxEWKJ_0qA&s" alt="Offer 1">
                </div>
                <div class="offer-card">
                    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiS8WlG721dlIrAwadNDBuG0eyoYhVeh4cOjZFtcdBzX7Ci10ZVkDMkigfy38wqcYjsDA28bPbdooL0KYNU8ysTV6L9XAKf4AGILv-iv90DFiKYhriYQB4v1IRMoYXwTTTUGmPYKbBzoWo/s16000/Flipkart+Big+Billion+Days+2020.jpg" alt="Offer 2">
                </div>
                <div class="offer-card">
                    <img src="https://www.getonecard.app/images/blog/best_dining_credit_cards.png" alt="Offer 3">
                </div>
                <div class="offer-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNSgw9k4cbdz2_J4vgok945SlpJYO4yYIhIuJ3EQzbXYr6W7dLPAxD8eBNeaLdPAkKoJ8&usqp=CAU" alt="Offer 4">
                </div>
                <div class="offer-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRWG4G_aVnrY7iNG2OBRkfQgCEDEHmMsWQ2qg&s" alt="Offer 5">
                </div>
                <!-- Duplicate offer cards for seamless looping effect -->
                <div class="offer-card">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTLoHP7NTqjpRpRII-RiIuBi7cuWxEWKJ_0qA&s" alt="Offer 1">
                </div>
                <div class="offer-card">
                    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiS8WlG721dlIrAwadNDBuG0eyoYhVeh4cOjZFtcdBzX7Ci10ZVkDMkigfy38wqcYjsDA28bPbdooL0KYNU8ysTV6L9XAKf4AGILv-iv90DFiKYhriYQB4v1IRMoYXwTTTUGmPYKbBzoWo/s16000/Flipkart+Big+Billion+Days+2020.jpg" alt="Offer 2">
                </div>
                <!-- Repeat for all cards -->
            </div>
        </div>
    </div>
    
  
    <div class="container categories-section">
        <h2 class="my-3">Categories</h2>
        <div class="categories-container">
            <!-- Example category items -->
            <div class="category-item">
                <img src="https://cdn.britannica.com/17/196817-159-9E487F15/vegetables.jpg" alt="Vegetable 1">
                <div class="category-overlay">Vegetable 1</div>
            </div>
            <div class="category-item">
                <img src="https://www.health.com/thmb/fbyHcuD2A3OrfZTC-LUJIPsKKVk=/2121x0/filters:no_upscale():max_bytes(150000):strip_icc()/HealthiestFruits-feb2318dc0a3454993007f57c724753f.jpg" alt="Vegetable 2">
            </div>
            <div class="category-item">
                <img src="https://cdn.insteading.com/wp-content/uploads/2022/05/chandan-chaurasia-N73L0EzbJ8Y-unsplash-1200x800.jpg" alt="Vegetable 3">
            </div>
            <div class="category-item">
                <img src="https://www.finedininglovers.com/sites/g/files/xknfdk626/files/styles/im_landscape_100/public/2022-11/Nuts.jpg.webp?itok=WIKJQ-aU" alt="Vegetable 4">
            </div>
            <div class="category-item">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRY_38OB-O3ct4_WTA4CLOW7rpDmuU8RkDVsQ&s" alt="Vegetable 5">
            </div>
            <div class="category-item">
                <img src="https://www.mayoclinichealthsystem.org/-/media/national-files/images/hometown-health/2021/eggs-in-a-wood-bowl.jpg?sc_lang=en" alt="Vegetable 6">
            </div>
            <!-- Add more items as needed -->
        </div>
    </div>

    <div class="container">
        <h2 class="mt-5">Vegetables</h2>
        <div class="product-list-container">
            <button class="arrow-button arrow-left" id="scrollLeft-vegetableList">←</button>
            <div class="product-list" id="vegetableList">
                <!-- Vegetable products will be injected here -->
            </div>
            <button class="arrow-button arrow-right" id="scrollRight-vegetableList">→</button>
        </div>
    
        <h2 class="mt-5">Fruits</h2>
        <div class="product-list-container">
            <button class="arrow-button arrow-left" id="scrollLeft-fruitList">←</button>
            <div class="product-list" id="fruitList">
                <!-- Fruit products will be injected here -->
            </div>
            <button class="arrow-button arrow-right" id="scrollRight-fruitList">→</button>
        </div>
    
        <h2 class="mt-5">Herbs</h2>
        <div class="product-list-container">
            <button class="arrow-button arrow-left" id="scrollLeft-herbsList">←</button>
            <div class="product-list" id="herbsList">
                <!-- Herbs products will be injected here -->
            </div>
            <button class="arrow-button arrow-right" id="scrollRight-herbsList">→</button>
        </div>
    </div>
    
  <!-- Footer -->
<footer class="bg-dark text-light mt-4">
  <div class="container">
    <div class="row">
      <!-- Company Info -->
      <div class="col-md-4 mb-3 mb-md-0 mt-4">
        <h5 class="">ULAVAN</h5>
        <p>Address Line 1</p>
        <p>Address Line 2</p>
        <p>Phone: (123) 456-7890</p>
        <p>Email: contact@company.com</p>
      </div>
      <!-- Navigation Links -->
      <div class="col-md-4 mb-3 mb-md-0 d-flex flex-column mt-4 ">
        <h5>Quick Links</h5>
        <a href="#" class="text-light mb-2">Home</a>
        <a href="#" class="text-light mb-2">About Us</a>
        <a href="#" class="text-light mb-2">Services</a>
        <a href="#" class="text-light mb-2">Contact</a>
        <a href="#" class="text-light mb-2">Privacy Policy</a>
        <a href="#" class="text-light mb-2">Terms of Service</a>
      </div>
      <!-- Social Media -->
      <div class="col-md-4 d-flex flex-column align-items-md-end mt-4">
        <h5>Follow Us</h5>
        <div class="d-flex">
          <a href="#" class="me-2 text-light"><i class="fab fa-facebook-f"></i></a>
          <a href="#" class="me-2 text-light"><i class="fab fa-twitter"></i></a>
          <a href="#" class="me-2 text-light"><i class="fab fa-instagram"></i></a>
          <a href="#" class="text-light"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
    </div>
    <div class="text-center mt-4">
      <p class="mb-0">&copy; 2024 Company Name. All rights reserved.</p>
    </div>
  </div>
</footer>

     
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
     <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
      import { getDatabase, ref, update, onValue } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";

      const firebaseConfig = {
          apiKey: "AIzaSyAKft0GluY81Wr7yCg23rk_d24iqSUAGzI",
          authDomain: "farmer-s-app-6ba74.firebaseapp.com",
          databaseURL: "https://farmer-s-app-6ba74-default-rtdb.firebaseio.com",
          projectId: "farmer-s-app-6ba74",
          storageBucket: "farmer-s-app-6ba74.appspot.com",
          messagingSenderId: "304658952728",
          appId: "1:304658952728:web:cfe48a70585fdb91d5c96d"
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const auth = getAuth(app);

      let userId;

      onAuthStateChanged(auth, (user) => {
          if (user) {
              userId = user.uid;
              console.log("User ID:", userId);
          } else {
              console.log("User is not signed in.");
          }
      });

      // Add to Cart Function
      window.addToCart = function(name, price, imageUrl, quantity, unit) {
          if (!userId) {
              alert("You must be logged in to add items to your cart.");
              return;
          }

          const product = {
              name: name,
              price: price,
              imageUrl: imageUrl,
              quantity: quantity,
              unit: unit
          };

          const cartRef = ref(db, `users/${userId}/cart`);

          update(cartRef, {
              [name]: product
          }).then(() => {
              console.log(`${name} added to cart!`);
              alert(`${name} added to your cart.`);
          }).catch((error) => {
              console.error("Error adding to cart:", error);
          });
      };

      function renderProducts(productData, containerId) {
          const productList = document.getElementById(containerId);
          productList.innerHTML = ''; // Clear existing products

          // Sort products by timestamp in descending order
          productData.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

          productData.forEach(product => {
              const productDiv = document.createElement('div');
              productDiv.className = 'col-md-3 product-item'; // Adjust class for responsive grid

              const productDate = new Date(product.timestamp);
              const currentTime = new Date();
              const timeDiff = Math.abs(currentTime - productDate) / 1000; // Difference in seconds

              const formattedPrice = product.price.toFixed(2);

              productDiv.innerHTML = `
                  <div class="card">
                      <div class="image-container" style="position:relative;">
                          <img src="${product.imageUrl || 'https://via.placeholder.com/150'}" class="card-img-top" alt="${product.name}">
                          ${timeDiff <= 10 ? `<div class="label" id="label-${product.name}" style="position:absolute; top:10px; left:10px; background-color:red; color:white; padding:5px; z-index:10;">New</div>` : ''}
                      </div>
                      <div class="card-body">
                          <h5 class="card-title">${product.name}</h5>
                          <p class="card-text">Store: ${product.store}</p>
                          <p class="card-text">Quantity: ${product.quantity} ${product.unit}</p>
                          <p class="card-text">Price: ₹${formattedPrice}</p>
                          <button class="btn btn-primary">
                              <span>Buy Now</span>
                              <i class="fa-solid fa-money-check"></i>
                          </button>
                         <button class="btn btn-secondary add-to-cart" onclick="addToCart('${product.name}', ${product.price}, '${product.imageUrl}', ${product.quantity}, '${product.unit}')">
                              <span>Add to Cart</span>
                              <i class="fa-solid fa-cart-shopping"></i>
                          </button>
                      </div>
                  </div>
              `;

              productList.appendChild(productDiv);

              if (timeDiff <= 10) {
                  setTimeout(() => {
                      const label = document.getElementById(`label-${product.name}`);
                      if (label) {
                          label.remove();
                          const productListItems = Array.from(productList.children);
                          const lastProduct = productListItems.find(item => item.querySelector(`#label-${product.name}`));
                          if (lastProduct) {
                              productList.removeChild(lastProduct);
                              productList.appendChild(lastProduct);
                          }
                      }
                  }, 10000); // 10 seconds
              }
          });
      }

      function listenForProductChanges(containerId, productType) {
          const productsRef = ref(db, 'users');
          
          onValue(productsRef, (snapshot) => {
              const products = [];
              snapshot.forEach(userSnapshot => {
                  const userProducts = userSnapshot.child('products').val();
                  for (let key in userProducts) {
                      if (userProducts[key].type === productType) {
                          products.push(userProducts[key]);
                      }
                  }
              });
              renderProducts(products, containerId);
          }, (error) => {
              console.error("Error fetching product data:", error);
          });
      }

      async function loadProductsByType(type, containerId) {
          listenForProductChanges(containerId, type);
      }

      async function loadAllProducts() {
          await loadProductsByType('vegetable', 'vegetableList');
          await loadProductsByType('fruit', 'fruitList');
          await loadProductsByType('herb', 'herbsList'); // Corrected ID
      }

      loadAllProducts();
    </script>
    
    <!-- Include Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
</body>
</html>
